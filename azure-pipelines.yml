# Runs after merge to main

trigger:
  - main

variables:
  - group: radius-angular

jobs:
  - job: setup_build_publish
    pool:
      vmImage: ubuntu-latest
      steps:
        - task: NodeTool@0
          inputs:
            versionSpec: "14.x"
            displayName: "Install Node.js"
            script: |
              npm ci
              npm run lint
              npm run test
              npm run build:ds
          displayName: "Install lint, test, build DS"
        - task: CopyFiles@2
          displayName: "Copy scripts"
          inputs:
            contents: "./dist/**"
            targetFolder: "$(Build.ArtifactStagingDirectory)"
        - publish: "$(Build.ArtifactStagingDirectory)/dist"
          displayName: "Publish DS"
          artifact: drop
